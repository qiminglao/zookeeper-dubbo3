!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(n="undefined"!=typeof globalThis?globalThis:n||self).simpleJsonRepair=e()}(this,function(){"use strict";var r,t,n=(r=function(n,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,e){n.__proto__=e}||function(n,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t])})(n,e)},function(n,e){function t(){this.constructor=n}r(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}),i=(t=SyntaxError,n(e,t),e);function e(n,e){n=t.call(this,n+" (char "+e+")")||this;return n.char=e,n}var f=["'","‘","’","`","´"],o=['"',"“","”"];function u(n){return/^[a-zA-Z_]$/.test(n)}function c(n){return"0"<=n&&n<="9"}function l(n){return" "===n||"\t"===n||"\n"===n||"\r"===n}function s(n){return" "===n||" "<=n&&n<=" "||" "===n||" "===n||"　"===n}function a(n){return f.includes(n)?"'":o.includes(n)?'"':n}function d(n,e){e=n.lastIndexOf(e);return-1!==e?n.substring(0,e)+n.substring(e+1):n}function h(n,e){return n.replace(/\s*$/,function(n){return e+n})}var p=0,b=1,w=2,g=3,v=4,x=5,y=6,_={"":!0,"{":!0,"}":!0,"[":!0,"]":!0,":":!0,",":!0,"(":!0,")":!0,";":!0,"+":!0},O={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},m={"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t"},I={null:"null",true:"true",false:"false"},j={None:"null",True:"true",False:"false"},k="",A="",$=0,E="",T="",F=y;function P(){$++,E=k.charAt($)}function S(){return F===p&&("["===T||"{"===T)||F===w||F===b||F===g}function U(){A+=T,F=y,T="",function(){if(_[E])return F=p,T=E,P();!function(){if(c(E)||"-"===E){if(F=b,"-"===E){if(T+=E,P(),!c(E))throw new i("Invalid number, digit expected",$)}else"0"===E&&(T+=E,P());for(;c(E);)T+=E,P();if("."===E){if(T+=E,P(),!c(E))throw new i("Invalid number, digit expected",$);for(;c(E);)T+=E,P()}if("e"===E||"E"===E){if(T+=E,P(),"+"!==E&&"-"!==E||(T+=E,P()),!c(E))throw new i("Invalid number, digit expected",$);for(;c(E);)T+=E,P()}return}!function(){if(function(n){return f.includes(n)||o.includes(n)}(E)){var n=a(E);for(T+='"',F=w,P();""!==E&&a(E)!==n;)if("\\"===E)if(P(),void 0!==O[E])T+="\\"+E,P();else if("u"===E){T+="\\u",P();for(var e=0;e<4;e++){if(!/^[0-9a-fA-F]$/.test(E))throw new i("Invalid unicode character",$-T.length);T+=E,P()}}else{if("'"!==E)throw new i('Invalid escape character "\\'+E+'"',$);T+="'",P()}else m[E]?T+=m[E]:T+='"'===E?'\\"':E,P();if(a(E)!==n)throw new i("End of string expected",$-T.length);return T+='"',P()}!function(){if(u(E)){for(F=g;u(E)||c(E)||"$"===E;)T+=E,P();return}!function(){if(l(E)||s(E)){for(F=v;l(E)||s(E);)T+=E,P();return}!function(){if("/"===E&&"*"===k[$+1]){for(F=x;""!==E&&("*"!==E||"*"===E&&"/"!==k[$+1]);)T+=E,P();return"*"===E&&"/"===k[$+1]&&(T+=E,P(),T+=E,P())}if("/"===E&&"/"===k[$+1]){for(F=x;""!==E&&"\n"!==E;)T+=E,P();return}!function(){F=y;for(;""!==E;)T+=E,P();throw new i('Syntax error in part "'+T+'"',$-T.length)}()}()}()}()}()}()}(),F===v&&(T=function(n){for(var e="",t=0;t<n.length;t++){var r=n[t];e+=s(r)?" ":r}return e}(T),U()),F===x&&(F=y,T="",U())}function z(){if(F!==p||"{"!==T)!function(){if(F===p&&"["===T){if(U(),F===p&&"]"===T)return U();for(;;)if(z(),F===p&&","===T){if(U(),F===p&&"]"===T){A=d(A,",");break}}else{if(!S())break;A=h(A,",")}return F===p&&"]"===T?U():A=h(A,"]")}!function(){if(F===w){for(U();F===p&&"+"===T;){var n;T="",U(),F===w&&(n=A.lastIndexOf('"'),A=A.substring(0,n)+T.substring(1),T="",U())}return}!function(){if(F===b)return U();!function(){if(F===g){if(I[T])return U();if(j[T])return T=j[T],U();var n=T,e=A.length;if(T="",U(),F===p&&"("===T)return T="",U(),z(),F===p&&")"===T&&(T="",U(),F===p&&";"===T&&(T="",U()));for(A=function(n,e,t){return n.substring(0,t)+e+n.substring(t)}(A,'"'+n,e);F===g||F===b;)U();return A+='"'}!function(){throw new i(""===T?"Unexpected end of json string":"Value expected",$-T.length)}()}()}()}()}();else if(U(),F!==p||"}"!==T){for(;;){if(F!==g&&F!==b||(F=w,T='"'+T+'"'),F!==w)throw new i("Object key expected",$-T.length);if(U(),F===p&&":"===T)U();else{if(!S())throw new i("Colon expected",$-T.length);A=h(A,":")}if(z(),F===p&&","===T){if(U(),F===p&&"}"===T){A=d(A,",");break}}else{if(F!==w&&F!==b&&F!==g)break;A=h(A,",")}}F===p&&"}"===T?U():A=h(A,"}")}else U()}return function(n){if(A="",$=0,E=(k=n).charAt(0),T="",F=y,U(),n=F===p&&"{"===T,z(),""===T)return A;if(n&&S()){for(;S();)A=h(A,","),z();return"[\n"+A+"\n]"}throw new i("Unexpected characters",$-T.length)}});